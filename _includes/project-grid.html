<section id="portfolio" class="project-grid">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 text-center">
          <h2>Projects</h2>
          <hr class="star-primary">
        </div>
      </div>
      <div class="grid">
        {% for post in site.posts %}
          <div class="project-card portfolio-item">
            <a href="#portfolioModal-{{ post.modal-id }}" class="portfolio-link" data-toggle="modal">
              <div class="project-image-container">
                <img src="img/portfolio/{{ post.img }}" alt="{{ post.alt }}" class="project-image">
                <div class="caption">
                  <div class="caption-content">
                    <svg class="eye-icon" viewBox="0 0 24 24" width="48" height="48">
                      <circle class="eye-outer" cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
                      <circle class="eye-inner" cx="12" cy="12" r="4" fill="currentColor"/>
                    </svg>
                  </div>
                </div>
              </div>
            </a>
            <div class="project-content">
              <h3>{{ post.title }}</h3>
              <p>{{ post.description | strip_html | truncatewords: 20 }}</p>
              {% if post.tags %}
                <div class="project-tags">
                  {% for service in post.services limit:3 %}
                    <span class="tag">{{ service }}</span>
                  {% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="project-links">
              <a href="#portfolioModal-{{ post.modal-id }}" class="button portfolio-link" data-toggle="modal">Details</a>
              {% if post.github_url %}
                <a href="{{ post.github_url }}" class="button github-button" target="_blank" rel="noopener noreferrer">
                  <i class="fab fa-github"></i>
                </a>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </section>
  
  <script>
  document.addEventListener('DOMContentLoaded', function () {
    const hash = window.location.hash;
    if (hash) {
      const modal = document.querySelector(hash);
      if (modal) {
        $(modal).modal('show');
      }
    }
  
    document.querySelectorAll('.portfolio-link').forEach(link => {
      link.addEventListener('click', function (e) {
        const targetModal = this.getAttribute('href');
        history.pushState(null, null, targetModal);
      });
    });
  
    window.addEventListener('popstate', function () {
      const hash = window.location.hash;
      if (hash) {
        const modal = document.querySelector(hash);
        if (modal) {
          $(modal).modal('show');
        }
      } else {
        $('.portfolio-modal').modal('hide');
      }
    });
  
    $('.portfolio-modal').on('hidden.bs.modal', function () {
      history.pushState(null, null, window.location.pathname);
    });
  });
  </script>